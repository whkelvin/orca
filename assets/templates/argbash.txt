#!/bin/bash

# m4_ignore(
#)Created by argbash-init v2.10.0

{{range $arg := .Arguments}} {{if ne $arg.IsEnvVariable true}} {{if ne $arg.ShortName ""}}
# ARG_OPTIONAL_SINGLE([{{$arg.Name}}], [{{$arg.ShortName}}])
{{else}}
# ARG_OPTIONAL_SINGLE([{{$arg.Name}}])
{{end}}{{end}}{{end}}

# ARG_HELP([<The general help message of my script>])
# ARGBASH_GO

# [

maskPrint () {
  local perc=75  ## percent to obfuscate
  local i=0
  for((i=0; i < ${#1}; i++))
  do
    if [ $(( $RANDOM % 100 )) -lt "$perc" ]
    then
        printf '%s' '*'
    else
        printf '%s' "${1:i:1}"
    fi
  done
  echo
}

printf '===== ENV VARIABLES ====='
{{range $arg := .Arguments}} {{if eq $arg.IsEnvVariable true}} {{if eq $arg.Mask true}}
printf '%s: ' '{{$arg.Name}}'
maskPrint "{{$arg.ToShellString}}"
{{else}}
printf 'Value of --%s: %s\n' '{{$arg.Name}}' "{{$arg.ToShellString}}"
{{end}} {{end}} {{end}}

printf '===== INPUT ARGUMENTS ====='
{{range $arg := .Arguments}} {{if eq $arg.IsEnvVariable false}} {{if eq $arg.Mask true}}
printf 'Value of --%s: ' '{{$arg.Name}}'
maskPrint "{{$arg.ToShellString}}"
{{else}}
printf 'Value of --%s: %s\n' '{{$arg.Name}}' "{{$arg.ToShellString}}"
{{end}} {{end}} {{end}}

{{.Script}}

# ]
